<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<title>Neon Flappy ‚Äì SpinnerRealYT Games</title>

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#020617">

<link rel="icon" type="image/png" href="../Logo.png?v=2">
<link rel="apple-touch-icon" href="../Logo.png?v=2">

<script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-auth-compat.js"></script>

<style>
:root{
  --bg:#020617;
  --card:#0f172a;
  --accent:#38bdf8;
  --text:#e5e7eb;
}

* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

body {
  margin: 0; 
  font-family: Inter, sans-serif;
  background: radial-gradient(circle at top, #1e293b, #020617);
  background-attachment: fixed;
  color: var(--text); 
  user-select: none;
  min-height: 100vh;
  padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
}

/* HEADER IDENTYCZNY JAK W SAPERZE */
header {
  display: flex; align-items: center; justify-content: space-between; gap: 15px; padding: 15px 20px;
  background: rgba(15, 23, 42, 0.9); 
  backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
  position: sticky; top: 0; z-index: 100;
  border-bottom: 1px solid rgba(56, 189, 248, 0.1);
}
header img { height: 32px; }

.account-box { text-align: right; }
.user-info { font-size: 13px; color: var(--accent); font-weight: bold; }
.sync-status { font-size: 9px; color: #64748b; margin-top: 2px; text-transform: uppercase; letter-spacing: 1px;}

nav button {
  background: none; border: none; color: var(--text); font-size: 15px;
  padding: 8px 14px; border-radius: 10px; cursor: pointer;
}
nav button:hover { background: rgba(56, 189, 248, 0.15); color: var(--accent); }

/* MAIN I CARD */
main { max-width: 600px; margin: auto; padding: 10px; }

.card {
  background: linear-gradient(180deg, #0f172a, #020617);
  border-radius: 24px; padding: 20px;
  box-shadow: 0 20px 60px rgba(0,0,0,.6);
  border: 1px solid rgba(255,255,255,0.05);
}

h2 { text-align: center; margin-top: 0; font-weight: 800; letter-spacing: -1px; }

/* SEKJA SCORE NAD GRƒÑ */
.score-header {
    text-align: center;
    margin-bottom: 15px;
    font-size: 24px;
    font-weight: 900;
    color: var(--text);
}
#score-num { color: var(--accent); text-shadow: 0 0 10px rgba(56, 189, 248, 0.5); }

/* GAME CONTAINER */
#game-container {
    position: relative;
    width: 320px;
    height: 480px;
    margin: 0 auto;
    border-radius: 16px;
    overflow: hidden;
    border: 2px solid var(--accent);
}

canvas { background: #000; display: block; width: 100%; height: 100%; }

#overlay {
    position: absolute;
    top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(15, 23, 42, 0.95);
    display: flex; flex-direction: column; justify-content: center; align-items: center;
    z-index: 10;
}

.diff-btn {
    background: var(--card);
    border: 1px solid var(--accent);
    color: var(--accent);
    padding: 12px 20px;
    margin: 6px;
    border-radius: 12px;
    cursor: pointer;
    width: 180px;
    font-weight: bold;
    transition: 0.2s;
}
.diff-btn:active { transform: scale(0.95); }

footer { text-align: center; opacity: 0.5; padding: 30px 20px; font-size: 11px; }
</style>
</head>
<body>

<header>
  <div style="display:flex; align-items:center; gap:10px;">
    <img src="../Logo.png" alt="SpinnerRealYT">
    <nav><button onclick="location.href='../index.html'">Wr√≥ƒá</button></nav>
  </div>
  <div class="account-box">
    <div id="user-display" class="user-info">GUEST</div>
    <div id="sync-display" class="sync-status">OFFLINE</div>
  </div>
</header>

<main>
  <div class="card">
    <h2>üöÄ Neon Flappy</h2>

    <div class="score-header">
        Score: <span id="score-num">0</span>
    </div>
    
    <div id="game-container">
        <canvas id="game" width="320" height="480"></canvas>
        
        <div id="overlay">
            <h3 id="status" style="margin-bottom: 15px;">Wybierz Poziom</h3>
            <div id="final-stats" style="margin-bottom: 15px; text-align: center; display: none;">
                <div style="font-size: 11px; opacity: 0.6;">TW√ìJ REKORD</div>
                <div id="best-score" style="font-size: 24px; font-weight: 800; color: var(--accent);">0</div>
            </div>
            <button class="diff-btn" onclick="initGame('amator')">AMATOR</button>
            <button class="diff-btn" onclick="initGame('latwy')">≈ÅATWY</button>
            <button class="diff-btn" onclick="initGame('sredni')">≈öREDNI</button>
            <button class="diff-btn" onclick="initGame('trudny')">HARDCORE</button>
        </div>
    </div>
  </div>
</main>

<footer>¬© 2026 SpinnerRealYT Games ‚Ä¢ iOS 26 Optimized</footer>

<script>
const firebaseConfig = { 
    apiKey: "AIzaSyByk8GJSoTJ_bgPNjyKnKi3o30E8bQB-qo",
    authDomain: "spinnerrealyt-games.firebaseapp.com",
    databaseURL: "https://spinnerrealyt-games-default-rtdb.europe-west1.firebasedatabase.app/" 
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();
const auth = firebase.auth();
const loggedUser = localStorage.getItem("sp_logged");

const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const scoreNum = document.getElementById("score-num");
const overlay = document.getElementById("overlay");
const syncEl = document.getElementById('sync-display');
const bestScoreEl = document.getElementById('best-score');

let bird = { x: 50, y: 240, w: 20, h: 20, dy: 0 };
let pipes = [];
let score = 0;
let isDead = true;
let frame = 0;
let highScore = 0;

const levels = {
    amator: { grav: 0.28, jump: -5.5, gap: 190, speed: 2, freq: 110 },
    latwy:  { grav: 0.38, jump: -6.5, gap: 160, speed: 2.5, freq: 100 },
    sredni: { grav: 0.48, jump: -7.5, gap: 140, speed: 3.2, freq: 90 },
    trudny: { grav: 0.62, jump: -8.8, gap: 120, speed: 4.2, freq: 75 }
};
let sets = levels.sredni;

// FIREBASE SYNC
auth.onAuthStateChanged((user) => {
    if(user && loggedUser) {
        document.getElementById('user-display').textContent = loggedUser.toUpperCase();
        loadBirdScore();
    } else if (loggedUser) {
        document.getElementById('user-display').textContent = loggedUser.toUpperCase();
        syncEl.textContent = "Connecting...";
    }
});

async function loadBirdScore() {
    if(!loggedUser) return;
    try {
        const snap = await db.ref('users/' + loggedUser + '/BirdScore').once('value');
        highScore = snap.exists() ? snap.val() : 0;
        bestScoreEl.textContent = highScore;
        syncEl.textContent = "Synced";
        syncEl.style.color = "#4ade80";
    } catch(e) { syncEl.textContent = "Error"; }
}

async function saveBirdScore(newScore) {
    if(!loggedUser || !auth.currentUser) return;
    if(newScore > highScore) {
        highScore = newScore;
        bestScoreEl.textContent = highScore;
        try {
            await db.ref('users/' + loggedUser).update({ BirdScore: highScore });
            syncEl.textContent = "Saved";
            syncEl.style.color = "#4ade80";
        } catch(e) { syncEl.textContent = "Sync Error"; }
    }
}

// LOGIKA GRY
function initGame(lvl) {
    sets = levels[lvl];
    bird.y = 240; bird.dy = 0; pipes = []; score = 0; frame = 0;
    scoreNum.textContent = "0";
    isDead = false;
    overlay.style.display = "none";
    gameLoop();
}

function jump() { if(!isDead) bird.dy = sets.jump; }

window.addEventListener("keydown", (e) => { if(e.code === "Space") { e.preventDefault(); jump(); }});
canvas.addEventListener("mousedown", jump);
canvas.addEventListener("touchstart", (e) => { e.preventDefault(); jump(); });

function gameLoop() {
    if(isDead) return;

    ctx.fillStyle = "#000";
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    bird.dy += sets.grav;
    bird.y += bird.dy;

    ctx.fillStyle = "#38bdf8";
    ctx.shadowBlur = 10; ctx.shadowColor = "#38bdf8";
    ctx.fillRect(bird.x, bird.y, bird.w, bird.h);
    ctx.shadowBlur = 0;

    if(frame % sets.freq === 0) {
        let gapPos = Math.random() * (canvas.height - sets.gap - 100) + 50;
        pipes.push({ x: canvas.width, y: gapPos, done: false });
    }

    for(let i = pipes.length - 1; i >= 0; i--) {
        let p = pipes[i];
        p.x -= sets.speed;

        ctx.fillStyle = "#1e293b";
        ctx.strokeStyle = "#38bdf8";
        ctx.lineWidth = 2;
        
        ctx.fillRect(p.x, 0, 50, p.y);
        ctx.strokeRect(p.x, -2, 50, p.y + 2);
        ctx.fillRect(p.x, p.y + sets.gap, 50, canvas.height);
        ctx.strokeRect(p.x, p.y + sets.gap, 50, canvas.height - (p.y + sets.gap) + 2);

        if (bird.x < p.x + 50 && bird.x + bird.w > p.x && (bird.y < p.y || bird.y + bird.h > p.y + sets.gap)) gameOver();
        
        if (!p.done && p.x + 50 < bird.x) {
            score++;
            p.done = true;
            scoreNum.textContent = score;
        }
        if (p.x < -60) pipes.splice(i, 1);
    }

    if(bird.y + bird.h > canvas.height || bird.y < 0) gameOver();

    frame++;
    requestAnimationFrame(gameLoop);
}

function gameOver() {
    isDead = true;
    saveBirdScore(score);
    document.getElementById("status").textContent = "Wynik: " + score;
    document.getElementById("final-stats").style.display = "block";
    overlay.style.display = "flex";
}
</script>
</body>
</html>
