<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Saper â€“ SpinnerRealYT Games</title>

<link rel="icon" type="image/png" href="../Logo.png?v=2">
<link rel="apple-touch-icon" href="../Logo.png?v=2">

<style>
:root{
  --bg:#020617;
  --card:#0f172a;
  --accent:#38bdf8;
  --text:#e5e7eb;
  /* Dynamiczny rozmiar komÃ³rki: min 20px, max 45px, idealnie 8% szerokoÅ›ci ekranu */
  --cell-size: clamp(20px, 8vw, 45px);
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Inter,system-ui,sans-serif;
  background:radial-gradient(circle at top,#020617,#000);
  color:var(--text);
  user-select: none;
}
header{
  display:flex; align-items:center; gap:15px; padding:15px 20px;
  background:rgba(15,23,42,.9); backdrop-filter:blur(10px);
  position:sticky; top:0; z-index:100;
}
header img{height:32px}
nav button{
  background:none; border:none; color:var(--text); font-size:15px;
  padding:8px 14px; border-radius:10px; cursor:pointer;
}
nav button:hover{ background:rgba(56,189,248,.15); color:var(--accent); }

main{ max-width: 600px; margin:auto; padding:10px; }
.card{
  background:linear-gradient(180deg,#0f172a,#020617);
  border-radius:20px; padding:15px;
  box-shadow:0 20px 60px rgba(0,0,0,.6);
}
h2{text-align:center; margin-top:0;}

#menu {
  display: flex; flex-wrap: wrap; justify-content: center; gap: 8px;
  margin-bottom: 15px; font-size: 14px;
}
input, button {
  background:#1e293b; color:white; border:1px solid #334155;
  border-radius:8px; padding:6px 10px;
}
button { cursor:pointer; background: var(--card); border-color: var(--accent); color: var(--accent); font-weight: bold;}
button:active { transform: scale(0.95); }

/* KONTENER GRY - SKALOWANIE */
#game {
  display: grid;
  justify-content: center;
  margin: 10px auto;
  gap: 3px;
  background: rgba(0,0,0,0.2);
  padding: 5px;
  border-radius: 8px;
  width: fit-content; /* WaÅ¼ne: dopasuj do zawartoÅ›ci */
  max-width: 100%;
}

.cell {
  width: var(--cell-size);
  height: var(--cell-size);
  background: #334155;
  display: flex; justify-content: center; align-items: center;
  cursor: pointer; font-weight: 700; border-radius: 4px;
  transition: background 0.2s;
  font-size: calc(var(--cell-size) * 0.5);
}
.open { background:#e5e7eb; color:#020617; }
.mine { background:#dc2626; color:white; }
.flagged { background:#facc15; color:#020617; }

/* Kolory cyferek */
.number1{color:#2563eb} .number2{color:#16a34a} .number3{color:#dc2626}
.number4{color:#1e3a8a} .number5{color:#7c2d12} .number6{color:#0f766e}

#controls-mobile {
  display: flex; justify-content: center; gap: 10px; margin-top: 15px;
}
.btn-mode { padding: 12px 20px; flex: 1; max-width: 150px; }
.active-mode { background: var(--accent); color: #020617; }

footer { text-align:center; opacity:.6; padding:20px; font-size: 12px;}
</style>
</head>
<body>

<header>
  <img src="../Logo.png" alt="SpinnerRealYT">
  <nav><button onclick="location.href='../index.html'">Menu</button></nav>
</header>

<main>
  <div class="card">
    <h2>ðŸ’£ Saper</h2>
    <div id="menu">
      <div style="display:flex; gap:5px; align-items:center;">
        Size: <input type="number" id="grid-size" value="9" min="5" max="15" style="width:50px">
        Bombs: <input type="number" id="bomb-count" value="10" min="5" style="width:50px">
      </div>
      <button id="start-btn">Nowa Gra</button>
      <div id="info">Flags: 0 / 10</div>
    </div>

    <div id="game"></div>

    <div id="controls-mobile">
      <button id="btn-open" class="btn-mode active-mode">Odkryj</button>
      <button id="btn-flag" class="btn-mode">Flaga</button>
    </div>
    
    <div id="points-info" style="text-align:center; margin-top:10px;">Points: 0</div>
  </div>
</main>

<footer>Â© 2026 SpinnerRealYT Games</footer>

<script>
(() => {
    let ROWS=9, COLS=9, MINES_COUNT=10;
    const gameEl=document.getElementById('game');
    const infoEl=document.getElementById('info');
    const startBtn=document.getElementById('start-btn');
    const gridSizeInput=document.getElementById('grid-size');
    const bombCountInput=document.getElementById('bomb-count');
    const btnOpen=document.getElementById('btn-open');
    const btnFlag=document.getElementById('btn-flag');
    const pointsInfoEl=document.getElementById('points-info');

    let cells=[], minePositions=new Set(), flags=new Set(), opened=new Set();
    let gameOver=false, flagMode=false, firstClick=true, points=0;

    function createGrid(){
        gameEl.innerHTML='';
        cells=[];
        // Ustawienie liczby kolumn w CSS Grid
        gameEl.style.gridTemplateColumns = `repeat(${COLS}, var(--cell-size))`;
        
        for(let i=0; i<ROWS*COLS; i++){
            const c=document.createElement('div');
            c.className='cell';
            c.dataset.index=i;
            c.onclick = () => handleCellClick(i);
            c.oncontextmenu = (e) => { e.preventDefault(); toggleFlag(i); };
            gameEl.appendChild(c);
            cells.push(c);
        }
    }

    function handleCellClick(i) {
        if(flagMode) toggleFlag(i);
        else openCell(i);
    }

    function neighbors(i){
        const r=Math.floor(i/COLS), c=i%COLS, res=[];
        for(let dr=-1; dr<=1; dr++) for(let dc=-1; dc<=1; dc++){
            if(!dr && !dc) continue;
            const nr=r+dr, nc=c+dc;
            if(nr>=0 && nr<ROWS && nc>=0 && nc<COLS) res.push(nr*COLS+nc);
        }
        return res;
    }

    function placeMines(firstIndex){
        minePositions.clear();
        while(minePositions.size < MINES_COUNT){
            const p = Math.floor(Math.random()*ROWS*COLS);
            if(p === firstIndex || neighbors(firstIndex).includes(p)) continue;
            minePositions.add(p);
        }
    }

    function openCell(i){
        if(gameOver || opened.has(i) || flags.has(i)) return;
        if(firstClick){ firstClick=false; placeMines(i); }
        
        opened.add(i);
        const c=cells[i];
        c.classList.add('open');
        
        if(minePositions.has(i)){
            c.textContent='ðŸ’£';
            c.classList.add('mine');
            return lose();
        }
        
        const n = neighbors(i).filter(idx => minePositions.has(idx)).length;
        if(n > 0){
            c.textContent = n;
            c.classList.add(`number${n}`);
        } else {
            neighbors(i).forEach(openCell);
        }
        checkWin();
    }

    function toggleFlag(i){
        if(gameOver || opened.has(i)) return;
        const c=cells[i];
        if(flags.has(i)){
            flags.delete(i);
            c.textContent='';
            c.classList.remove('flagged');
        } else if(flags.size < MINES_COUNT){
            flags.add(i);
            c.textContent='ðŸš©';
            c.classList.add('flagged');
        }
        infoEl.textContent=`Flags: ${flags.size} / ${MINES_COUNT}`;
    }

    function lose(){
        gameOver=true;
        infoEl.textContent='ðŸ’¥ Przegrana!';
        minePositions.forEach(i => {
            cells[i].classList.add('mine', 'open');
            cells[i].textContent='ðŸ’£';
        });
    }

    function checkWin(){
        if(opened.size === ROWS*COLS - MINES_COUNT){
            gameOver=true;
            infoEl.textContent='ðŸŽ‰ Wygrana!';
            points += 10;
            pointsInfoEl.textContent = `Points: ${points}`;
        }
    }

    function reset(){
        ROWS = Math.min(parseInt(gridSizeInput.value) || 9, 15); // limit dla mobile
        COLS = ROWS;
        MINES_COUNT = Math.min(parseInt(bombCountInput.value) || 10, Math.floor(ROWS*COLS*0.3));
        gameOver=false; firstClick=true;
        flags.clear(); opened.clear();
        infoEl.textContent=`Flags: 0 / ${MINES_COUNT}`;
        createGrid();
    }

    startBtn.onclick = reset;
    
    btnOpen.onclick = () => {
        flagMode = false;
        btnOpen.classList.add('active-mode');
        btnFlag.classList.remove('active-mode');
    };
    
    btnFlag.onclick = () => {
        flagMode = true;
        btnFlag.classList.add('active-mode');
        btnOpen.classList.remove('active-mode');
    };

    reset();
})();
</script>
</body>
</html>
