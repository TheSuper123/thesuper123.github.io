<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Block Blast â€“ SpinnerRealYT Games</title>
<link rel="icon" href="../Logo.png">

<style>
:root{
  --bg:#020617;
  --card:#0f172a;
  --accent:#38bdf8;
  --text:#e5e7eb;
}
*{box-sizing:border-box;}
body{
  margin:0;
  font-family:Inter,system-ui,sans-serif;
  background:radial-gradient(circle at top,#020617,#000);
  color:var(--text);
}
header{
  display:flex;
  align-items:center;
  justify-content:flex-start;
  padding:15px 20px;
  background:rgba(15,23,42,.9);
  backdrop-filter:blur(10px);
  position:sticky;
  top:0;
  z-index:100;
}
header img{height:42px;margin-right:20px;}
header button{
  background:none;
  border:none;
  color:var(--text);
  font-size:15px;
  padding:8px 14px;
  border-radius:10px;
  cursor:pointer;
}
header button:hover{
  background:rgba(56,189,248,.15);
  color:var(--accent);
}
main{max-width:1100px;margin:auto;padding:25px}
.card{
  background:linear-gradient(180deg,#0f172a,#020617);
  border-radius:20px;
  padding:20px;
  box-shadow:0 20px 60px rgba(0,0,0,.6);
  margin-bottom:25px;
}
h2{text-align:center;margin:0 0 15px 0;}
footer{
  text-align:center;
  opacity:.6;
  padding:25px 10px;
}
#score{
  text-align:center;
  font-size:22px;
  font-weight:bold;
  margin-bottom:15px;
}
#board{
  display:grid;
  grid-template-columns:repeat(9,40px);
  grid-template-rows:repeat(9,40px);
  gap:2px;
  justify-content:center;
  position:relative;
}
.cell{
  width:40px;
  height:40px;
  background:#334155;
  border-radius:5px;
  position:relative;
}
#next-blocks{
  display:flex;
  justify-content:center;
  gap:15px;
  margin-top:15px;
  flex-wrap:wrap;
}
.block{
  display:grid;
  cursor:pointer;
  user-select:none;
  position:relative;
}
.block-cell{
  width:40px;
  height:40px;
  border-radius:3px;
  border:1px solid #020617;
}
.ghost-cell{
  position:absolute;
  width:40px;
  height:40px;
  border-radius:3px;
  opacity:0.5;
  pointer-events:none;
  z-index:10;
}
</style>
</head>

<body>

<header>
<img src="../Logo.png" alt="SpinnerRealYT">
<button onclick="location.href='../index.html'">Menu</button>
</header>

<main>
<div class="card">
<h2>ðŸŸ¦ Block Blast 9x9</h2>
<div id="score">Punkty: 0</div>
<div id="board"></div>
<div id="next-blocks"></div>
</div>
</main>

<footer>
Â© 2026 SpinnerRealYT Games
</footer>

<script>
const ROWS=9,COLS=9,CELL_SIZE=40;
const COLORS=["#2563eb","#16a34a","#dc2626","#f59e0b","#8b5cf6"];
const SHAPES=[
  [[1,1,1]],          // pozioma
  [[1],[1],[1]],      // pionowa
  [[1,1],[1,1]],      // kwadrat
  [[1,1,1],[0,1,0]],  // T
  [[1,1,0],[0,1,1]],  // S
  [[0,1,1],[1,1,0]],  // Z
];

const boardEl=document.getElementById("board");
const nextEl=document.getElementById("next-blocks");
const scoreEl=document.getElementById("score");

let board=[], score=0, nextBlocks=[];
let ghost=[];

function init(){
  board=Array.from({length:ROWS},()=>Array(COLS).fill(null));
  boardEl.innerHTML="";
  for(let r=0;r<ROWS;r++){
    for(let c=0;c<COLS;c++){
      const cell=document.createElement("div");
      cell.className="cell";
      cell.dataset.r=r;
      cell.dataset.c=c;
      boardEl.appendChild(cell);
    }
  }
  score=0;
  updateScore();
  generateNext();
}

function updateScore(){ scoreEl.textContent="Punkty: "+score; }

function generateNext(){
  nextEl.innerHTML="";
  nextBlocks=[];
  for(let i=0;i<3;i++){
    const shape=SHAPES[Math.floor(Math.random()*SHAPES.length)];
    const color=COLORS[Math.floor(Math.random()*COLORS.length)];
    const blockDiv=document.createElement("div");
    blockDiv.className="block";
    blockDiv.dataset.shape=JSON.stringify(shape);
    blockDiv.dataset.color=color;
    blockDiv.style.gridTemplateColumns=`repeat(${shape[0].length},${CELL_SIZE}px)`;
    for(let r=0;r<shape.length;r++){
      for(let c=0;c<shape[r].length;c++){
        if(shape[r][c]){
          const sq=document.createElement("div");
          sq.className="block-cell";
          sq.style.background=color;
          blockDiv.appendChild(sq);
        }
      }
    }
    nextEl.appendChild(blockDiv);
    nextBlocks.push({div:blockDiv,shape,color});
    makeDraggable(blockDiv);
  }
}

function makeDraggable(block){
  block.onmousedown=function(e){
    e.preventDefault();
    const shape=JSON.parse(block.dataset.shape);
    const color=block.dataset.color;
    const offsetX=e.offsetX;
    const offsetY=e.offsetY;

    // Ghost na planszy
    ghost.forEach(g=>g.div.remove());
    ghost=[];
    for(let r=0;r<shape.length;r++){
      for(let c=0;c<shape[r].length;c++){
        if(shape[r][c]){
          const g=document.createElement("div");
          g.className="ghost-cell";
          g.style.background=color;
          boardEl.appendChild(g);
          ghost.push({div:g,r,c});
        }
      }
    }

    function moveBlock(ev){
      // normalny blok przy myszce
      block.style.position="absolute";
      block.style.left=ev.pageX-offsetX+"px";
      block.style.top=ev.pageY-offsetY+"px";

      // oblicz pozycjÄ™ wzglÄ™dem planszy
      const rect=boardEl.getBoundingClientRect();
      let col=Math.floor((ev.clientX-rect.left)/CELL_SIZE);
      let row=Math.floor((ev.clientY-rect.top)/CELL_SIZE);

      if(canPlace(row,col,shape)){
        ghost.forEach(g=>{
          g.div.style.left=(col+g.c)*CELL_SIZE+"px";
          g.div.style.top=(row+g.r)*CELL_SIZE+"px";
        });
      } else {
        ghost.forEach(g=>{
          g.div.style.left="-100px";
          g.div.style.top="-100px";
        });
      }
    }

    function dropBlock(ev){
      document.removeEventListener("mousemove",moveBlock);
      document.removeEventListener("mouseup",dropBlock);

      const rect=boardEl.getBoundingClientRect();
      let col=Math.floor((ev.clientX-rect.left)/CELL_SIZE);
      let row=Math.floor((ev.clientY-rect.top)/CELL_SIZE);

      if(canPlace(row,col,shape)){
        placeBlock(row,col,shape,color);
        block.remove();
        nextBlocks=nextBlocks.filter(b=>b.div!==block);
        if(nextBlocks.length===0) generateNext();
      } else {
        block.style.position="";
        block.style.left="";
        block.style.top="";
      }

      ghost.forEach(g=>g.div.remove());
      ghost=[];
    }

    document.addEventListener("mousemove",moveBlock);
    document.addEventListener("mouseup",dropBlock);
  }
}

function canPlace(r,c,shape){
  for(let dr=0;dr<shape.length;dr++){
    for(let dc=0;dc<shape[dr].length;dc++){
      if(shape[dr][dc]){
        if(r+dr>=ROWS||c+dc>=COLS||board[r+dr][c+dc]) return false;
      }
    }
  }
  return true;
}

function placeBlock(r,c,shape,color){
  shape.forEach((row,dr)=>{
    row.forEach((cell,dc)=>{
      if(cell) board[r+dr][c+dc]=color;
    });
  });
  updateBoard();
  removeFull();
  updateScore();
}

function updateBoard(){
  [...boardEl.children].forEach(cell=>{
    const r=parseInt(cell.dataset.r);
    const c=parseInt(cell.dataset.c);
    cell.style.background=board[r][c]||"#334155";
  });
}

function removeFull(){
  let lines=0;
  for(let r=0;r<ROWS;r++){
    if(board[r].every(v=>v)){ lines++; board[r]=Array(COLS).fill(null);}
  }
  for(let c=0;c<COLS;c++){
    if(board.every(row=>row[c])){ lines++; for(let r=0;r<ROWS;r++) board[r][c]=null;}
  }
  score+=lines*10;
  updateBoard();
}

init();
</script>

</body>
</html>
